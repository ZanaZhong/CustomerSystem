(function(){"use strict";var t={118:function(t,e,n){var o=n(751),r=n(641);const s={id:"app"},a={class:"navbar"},u={class:"nav-links"},l={class:"content"};function i(t,e,n,o,i,c){const d=(0,r.g2)("router-link"),m=(0,r.g2)("router-view");return(0,r.uX)(),(0,r.CE)("div",s,[(0,r.Lk)("nav",a,[e[2]||(e[2]=(0,r.Lk)("div",{class:"logo"},"My App",-1)),(0,r.Lk)("div",u,[(0,r.bF)(d,{to:"/customers",class:"nav-item"},{default:(0,r.k6)((()=>e[0]||(e[0]=[(0,r.eW)("客戶頁面")]))),_:1}),(0,r.bF)(d,{to:"/transactions",class:"nav-item"},{default:(0,r.k6)((()=>e[1]||(e[1]=[(0,r.eW)("交易頁面")]))),_:1})])]),(0,r.Lk)("div",l,[(0,r.bF)(m)])])}var c={name:"App"},d=n(262);const m=(0,d.A)(c,[["render",i]]);var p=m,f=n(220),h=n(33);const k={class:"customer-page"},b={class:"form-section"},v={class:"form-group"},L={class:"form-group"},C={class:"table-section"},y={class:"customer-table"},g=["onClick"],w={key:0,class:"form-section"},D={class:"form-group"},E={class:"form-group"};function _(t,e,n,s,a,u){return(0,r.uX)(),(0,r.CE)("div",k,[e[15]||(e[15]=(0,r.Lk)("h1",null,"客戶資料",-1)),(0,r.Lk)("div",b,[e[9]||(e[9]=(0,r.Lk)("h2",null,"新增客戶",-1)),(0,r.Lk)("form",{onSubmit:e[2]||(e[2]=(0,o.D$)(((...t)=>u.submitNewCustomer&&u.submitNewCustomer(...t)),["prevent"])),class:"form"},[(0,r.Lk)("div",v,[e[6]||(e[6]=(0,r.Lk)("label",{for:"name"},"名稱",-1)),(0,r.bo)((0,r.Lk)("input",{type:"text",id:"name","onUpdate:modelValue":e[0]||(e[0]=t=>a.newCustomer.name=t),required:""},null,512),[[o.Jo,a.newCustomer.name]])]),(0,r.Lk)("div",L,[e[7]||(e[7]=(0,r.Lk)("label",{for:"email"},"電子郵件",-1)),(0,r.bo)((0,r.Lk)("input",{type:"email",id:"email","onUpdate:modelValue":e[1]||(e[1]=t=>a.newCustomer.email=t),required:""},null,512),[[o.Jo,a.newCustomer.email]])]),e[8]||(e[8]=(0,r.Lk)("button",{type:"submit",class:"btn btn-primary"},"新增客戶",-1))],32)]),(0,r.Lk)("div",C,[(0,r.Lk)("table",y,[e[10]||(e[10]=(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"客戶名稱"),(0,r.Lk)("th",null,"電子郵件"),(0,r.Lk)("th",null,"去年總交易金額"),(0,r.Lk)("th",null,"操作")])],-1)),(0,r.Lk)("tbody",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(a.customers,(t=>((0,r.uX)(),(0,r.CE)("tr",{key:t.id},[(0,r.Lk)("td",null,(0,h.v_)(t.name),1),(0,r.Lk)("td",null,(0,h.v_)(t.email),1),(0,r.Lk)("td",null,(0,h.v_)(t.total_amount_last_year),1),(0,r.Lk)("td",null,[(0,r.Lk)("button",{onClick:e=>u.editCustomer(t),class:"btn btn-secondary"}," 編輯 ",8,g)])])))),128))])])]),a.editingCustomer?((0,r.uX)(),(0,r.CE)("div",w,[e[14]||(e[14]=(0,r.Lk)("h3",null,"編輯客戶",-1)),(0,r.Lk)("form",{onSubmit:e[5]||(e[5]=(0,o.D$)(((...t)=>u.submitUpdate&&u.submitUpdate(...t)),["prevent"])),class:"form"},[(0,r.Lk)("div",D,[e[11]||(e[11]=(0,r.Lk)("label",{for:"editName"},"名稱",-1)),(0,r.bo)((0,r.Lk)("input",{type:"text",id:"editName","onUpdate:modelValue":e[3]||(e[3]=t=>a.editingCustomer.name=t),required:""},null,512),[[o.Jo,a.editingCustomer.name]])]),(0,r.Lk)("div",E,[e[12]||(e[12]=(0,r.Lk)("label",{for:"editEmail"},"電子郵件",-1)),(0,r.bo)((0,r.Lk)("input",{type:"email",id:"editEmail","onUpdate:modelValue":e[4]||(e[4]=t=>a.editingCustomer.email=t),required:""},null,512),[[o.Jo,a.editingCustomer.email]])]),e[13]||(e[13]=(0,r.Lk)("button",{type:"submit",class:"btn btn-primary"},"更新資料",-1))],32)])):(0,r.Q3)("",!0)])}var O=n(335),U={data(){return{customers:[],newCustomer:{name:"",email:""},editingCustomer:null,isUpdating:!1}},mounted(){this.fetchCustomers()},methods:{async fetchCustomers(){try{const t=await O.A.get("http://localhost:8888/customers");this.customers=t.data}catch(t){console.error("無法取得客戶資料",t)}},async submitNewCustomer(){try{await O.A.post("http://localhost:8888/customers",this.newCustomer),alert("新增成功！"),this.fetchCustomers(),this.newCustomer={name:"",email:""}}catch(t){console.error("新增失敗",t)}},editCustomer(t){this.editingCustomer={...t}},async submitUpdate(){this.isUpdating=!0;try{await O.A.put(`http://localhost:8888/customers/${this.editingCustomer.id}`,this.editingCustomer),await this.fetchCustomers(),alert("更新成功！"),this.editingCustomer=null}catch(t){console.error("更新失敗",t)}finally{this.isUpdating=!1}}}};const X=(0,d.A)(U,[["render",_]]);var A=X;const S=["value"],j={key:0},q={key:1};function F(t,e,n,s,a,u){return(0,r.uX)(),(0,r.CE)("div",null,[e[9]||(e[9]=(0,r.Lk)("h1",null,"客戶資料",-1)),e[10]||(e[10]=(0,r.Lk)("h2",null,"查詢客戶交易紀錄",-1)),(0,r.Lk)("form",{onSubmit:e[3]||(e[3]=(0,o.D$)(((...t)=>u.fetchCustomerTransactions&&u.fetchCustomerTransactions(...t)),["prevent"]))},[(0,r.Lk)("div",null,[e[4]||(e[4]=(0,r.Lk)("label",{for:"customerSelect"},"選擇客戶",-1)),(0,r.bo)((0,r.Lk)("select",{"onUpdate:modelValue":e[0]||(e[0]=t=>a.selectedCustomerId=t),id:"customerSelect",required:""},[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(a.customers,(t=>((0,r.uX)(),(0,r.CE)("option",{key:t.id,value:t.id},(0,h.v_)(t.name),9,S)))),128))],512),[[o.u1,a.selectedCustomerId]])]),(0,r.Lk)("div",null,[e[5]||(e[5]=(0,r.Lk)("label",{for:"startDate"},"開始日期",-1)),(0,r.bo)((0,r.Lk)("input",{type:"date",id:"startDate","onUpdate:modelValue":e[1]||(e[1]=t=>a.startDate=t),required:""},null,512),[[o.Jo,a.startDate]])]),(0,r.Lk)("div",null,[e[6]||(e[6]=(0,r.Lk)("label",{for:"endDate"},"結束日期",-1)),(0,r.bo)((0,r.Lk)("input",{type:"date",id:"endDate","onUpdate:modelValue":e[2]||(e[2]=t=>a.endDate=t),required:""},null,512),[[o.Jo,a.endDate]])]),e[7]||(e[7]=(0,r.Lk)("button",{type:"submit"},"查詢交易紀錄",-1))],32),a.transactions.length>0?((0,r.uX)(),(0,r.CE)("table",j,[e[8]||(e[8]=(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"客戶"),(0,r.Lk)("th",null,"交易日期"),(0,r.Lk)("th",null,"金額")])],-1)),(0,r.Lk)("tbody",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(a.transactions,(t=>((0,r.uX)(),(0,r.CE)("tr",{key:t.id},[(0,r.Lk)("td",null,(0,h.v_)(t.id),1),(0,r.Lk)("td",null,(0,h.v_)(t.date),1),(0,r.Lk)("td",null,(0,h.v_)(t.amount),1)])))),128))])])):((0,r.uX)(),(0,r.CE)("p",q,"尚未查詢到交易紀錄"))])}var I={data(){return{customers:[],selectedCustomerId:null,startDate:"",endDate:"",transactions:[]}},mounted(){this.fetchCustomers()},methods:{async fetchCustomers(){try{const t=await O.A.get("http://localhost:8888/customers");this.customers=t.data}catch(t){console.error("無法取得客戶資料",t)}},async fetchCustomerTransactions(){try{const t=await O.A.get(`http://localhost:8888/transactions/${this.selectedCustomerId}`,{params:{startDate:this.startDate,endDate:this.endDate}});this.transactions=t.data}catch(t){alert(`查詢失敗: ${t.response?.data?.error||"伺服器錯誤"}`),console.error("查詢交易紀錄失敗",t)}}}};const T=(0,d.A)(I,[["render",F]]);var V=T;const x=[{path:"/",redirect:"/customers"},{path:"/customers",component:A},{path:"/transactions",component:V}],J=(0,f.aE)({history:(0,f.LA)(),routes:x});var $=J;const N=(0,o.Ef)(p);N.use($),N.mount("#app")}},e={};function n(o){var r=e[o];if(void 0!==r)return r.exports;var s=e[o]={exports:{}};return t[o](s,s.exports,n),s.exports}n.m=t,function(){var t=[];n.O=function(e,o,r,s){if(!o){var a=1/0;for(c=0;c<t.length;c++){o=t[c][0],r=t[c][1],s=t[c][2];for(var u=!0,l=0;l<o.length;l++)(!1&s||a>=s)&&Object.keys(n.O).every((function(t){return n.O[t](o[l])}))?o.splice(l--,1):(u=!1,s<a&&(a=s));if(u){t.splice(c--,1);var i=r();void 0!==i&&(e=i)}}return e}s=s||0;for(var c=t.length;c>0&&t[c-1][2]>s;c--)t[c]=t[c-1];t[c]=[o,r,s]}}(),function(){n.d=function(t,e){for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){var t={524:0};n.O.j=function(e){return 0===t[e]};var e=function(e,o){var r,s,a=o[0],u=o[1],l=o[2],i=0;if(a.some((function(e){return 0!==t[e]}))){for(r in u)n.o(u,r)&&(n.m[r]=u[r]);if(l)var c=l(n)}for(e&&e(o);i<a.length;i++)s=a[i],n.o(t,s)&&t[s]&&t[s][0](),t[s]=0;return n.O(c)},o=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];o.forEach(e.bind(null,0)),o.push=e.bind(null,o.push.bind(o))}();var o=n.O(void 0,[504],(function(){return n(118)}));o=n.O(o)})();
//# sourceMappingURL=app.c205328b.js.map